{% macro render_menu_item(item) %}
    {% import _self as macros %}
    {% set has_children = item.children is defined and item.children|length > 0 %}
    {% set is_active = item.route is defined and is_active_route(item.route) %}
    {% set has_active_child = has_children and has_active_child(item.children) %}
    {% set is_open = is_active or has_active_child %}

    <li class="nav-item {{ is_open ? 'menu-open' : '' }}">
        {% if has_children %}
            <a href="#" class="nav-link {{ is_open ? 'active' : '' }}">
                <i class="{{ item.icon }}"></i>
                <p>
                    {{ item.label }}
                    <i class="right fas fa-angle-left"></i>
                </p>
            </a>
            <ul class="nav nav-treeview">
                {% for child in item.children %}
                    {{ macros.render_menu_item(child) }}
                {% endfor %}
            </ul>
        {% else %}
            <a href="{{ route_redirect(item.route) }}" class="nav-link {{ is_active ? 'active' : '' }}">
                <i class="{{ item.icon }}"></i>
                <p>{{ item.label }}</p>
            </a>
        {% endif %}
    </li>
{% endmacro %}

<ul class="nav nav-pills nav-sidebar flex-column" data-accordion="false">
    {% import _self as macros %}
    {% for item in menu_items %}
        {{ macros.render_menu_item(item) }}
    {% endfor %}
</ul>
